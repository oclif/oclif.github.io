"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3782],{2381:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>a,contentTitle:()=>l,default:()=>d,frontMatter:()=>s,metadata:()=>r,toc:()=>c});var i=t(4848),o=t(8453);const s={title:"Just-in-Time Plugin Installation",description:"Support for just-in-time plugin installation"},l=void 0,r={id:"jit_plugins",title:"Just-in-Time Plugin Installation",description:"Support for just-in-time plugin installation",source:"@site/../docs/jit_plugins.md",sourceDirName:".",slug:"/jit_plugins",permalink:"/docs/jit_plugins",draft:!1,unlisted:!1,editUrl:"https://github.com/oclif/oclif.github.io/tree/docs/docs/../docs/jit_plugins.md",tags:[],version:"current",lastUpdatedBy:"Mike Donnalley",lastUpdatedAt:1722030837e3,frontMatter:{title:"Just-in-Time Plugin Installation",description:"Support for just-in-time plugin installation"},sidebar:"docs",previous:{title:"Flexible Taxonomy",permalink:"/docs/flexible_taxonomy"},next:{title:"JSON",permalink:"/docs/json"}},a={},c=[];function u(n){const e={a:"a",code:"code",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.p,{children:"Sometimes you might want to have a plugin that isn't bundled in your CLI but gets installed the first time it's executed by the user - we call this just-in-time plugin installation, or JIT for short. This can be useful if you need to reduce the package size of your CLI while still allowing users access to all the plugins."}),"\n",(0,i.jsx)(e.p,{children:"To use this feature you need to:"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:["Add ",(0,i.jsx)(e.code,{children:"jitPlugins"})," to the ",(0,i.jsx)(e.code,{children:"oclif"})," section of your package.json"]}),"\n"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-json",children:'"oclif": {\n  "jitPlugins": {\n    "my-plugin": "^1.2.3",\n    "another-plugin": "^1.2.3",\n  }\n}\n'})}),"\n",(0,i.jsxs)(e.ol,{start:"2",children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Ensure that your build process includes generating a manifest using ",(0,i.jsx)(e.code,{children:"oclif manifest"}),". The manifest will include the information about all the commands owned by JIT plugins which allows users to run ",(0,i.jsx)(e.code,{children:"--help"})," on those commands without having them installed yet. ",(0,i.jsx)(e.strong,{children:"If the generated manifest doesn't get packed with your CLI, then the feature will not work."})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["Implement the ",(0,i.jsx)(e.code,{children:"jit_plugin_not_installed"})," hook."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["oclif attempts to be UX-agnostic, meaning that we don't want to impose any particular user experience on you. Any time a user experience is required we utilize ",(0,i.jsx)(e.a,{href:"/docs/hooks",children:"hooks"})," so that you can design the exact user experience you want your users to have."]}),"\n",(0,i.jsx)(e.p,{children:"In the case of JIT plugin installation, there are many possible user experiences that you might want - maybe you want to prompt the user for confirmation first, or maybe you want to log a specific message, etc..."}),"\n",(0,i.jsx)(e.p,{children:"Here's an example of how you might implement the hook,"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"import { Hook, Errors } from '@oclif/core';\nimport confirm from '@inquirer/confirm';\n\nconst hook: Hook.JitPluginNotInstalled = async function (opts) {\n  try {\n    const answer = await confirm({\n      message: `${opts.command.pluginName} not installed. Would you like to install?`\n    })\n    if (answer) {\n      await opts.config.runCommand('plugins:install', [`${opts.command.pluginName}@${opts.pluginVersion}`]);\n    }\n  } catch (error) {\n    throw new Errors.CLIError(`Could not install ${opts.command.pluginName}`, 'JitPluginInstallError');\n  }\n};\n\nexport default hook;\n\n"})})]})}function d(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(u,{...n})}):u(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>l,x:()=>r});var i=t(6540);const o={},s=i.createContext(o);function l(n){const e=i.useContext(s);return i.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:l(n.components),i.createElement(s.Provider,{value:e},n.children)}}}]);